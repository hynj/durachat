import{c as R,a as t,d as dt,f as _,t as Q,s as ye,h as ct}from"../chunks/BDdIJgRh.js";import"../chunks/DU4ySZei.js";import{f as o,p as vt,s as oe,a as ut,o as ft,b as _t,d as i,e as s,c as z,g as e,n as P,r,t as be,S as Be,$ as pt}from"../chunks/Bcdcg6QJ.js";import{i as H}from"../chunks/CGJFYSJu.js";import{I as Ce,s as Se,B as pe,e as He,i as Re,b as qe}from"../chunks/BNH1bgBz.js";import{l as Ae,s as Le,c as g}from"../chunks/HP_sVpL7.js";import{t as me,a as ze,I as Ge,C as Ye}from"../chunks/af7Bwi91.js";import{d as de,e as ce,C as Pe,b as we,K as mt,c as Oe,B as ke,a as $t}from"../chunks/1GFsE5rG.js";import{c as Je}from"../chunks/B6bYGZD0.js";import{g as gt}from"../chunks/Cy-hLvyf.js";import{S as ht}from"../chunks/SQJLBodO.js";import{A as xt,C as Qe,S as We,a as yt}from"../chunks/D6uErJo2.js";import{L as Xe}from"../chunks/BQlalapJ.js";function bt(O,b){const d=Ae(b,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143"}],["path",{d:"m2 2 20 20"}]];Ce(O,Le({name:"eye-off"},()=>d,{get iconNode(){return l},children:(D,W)=>{var w=R(),q=o(w);Se(q,b,"default",{}),t(D,w)},$$slots:{default:!0}}))}function Pt(O,b){const d=Ae(b,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["circle",{cx:"12",cy:"12",r:"3"}]];Ce(O,Le({name:"eye"},()=>d,{get iconNode(){return l},children:(D,W)=>{var w=R(),q=o(w);Se(q,b,"default",{}),t(D,w)},$$slots:{default:!0}}))}function wt(O,b){const d=Ae(b,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];Ce(O,Le({name:"save"},()=>d,{get iconNode(){return l},children:(D,W)=>{var w=R(),q=o(w);Se(q,b,"default",{}),t(D,w)},$$slots:{default:!0}}))}function kt(O,b){const d=Ae(b,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["path",{d:"M12 9v4"}],["path",{d:"M12 17h.01"}]];Ce(O,Le({name:"triangle-alert"},()=>d,{get iconNode(){return l},children:(D,W)=>{var w=R(),q=o(w);Se(q,b,"default",{}),t(D,w)},$$slots:{default:!0}}))}var Ct=_("<!> Back to Chat",1),St=_('<!> <span class="ml-2">Loading settings...</span>',1),At=_('<div class="text-destructive flex items-center gap-2"><!> <span> </span></div> <!>',1),Lt=_("<!> API Keys",1),Mt=_("<!> <!>",1),It=_("<!> Configured",1),Kt=(O,b,d)=>b(e(d).name),Et=_('<div class="space-y-2"><div class="flex items-center justify-between"><label class="text-sm font-medium"> </label> <!></div> <div class="flex gap-2"><div class="relative flex-1"><!> <button type="button" class="absolute inset-y-0 right-0 flex items-center pr-3"><!></button></div> <!></div></div>'),Ft=_('<div class="space-y-4"></div>'),jt=_("<!> <!>",1),Nt=_("<!> Login Code",1),Tt=_("<!> <!>",1),Bt=_('<p class="text-sm text-green-600">Copied to clipboard!</p>'),zt=_(`<div class="space-y-4"><div class="space-y-2"><label class="text-sm font-medium">Your Login Code</label> <div class="flex items-center space-x-2"><!> <!></div> <!></div> <div class="rounded-lg bg-amber-50 p-3 dark:bg-amber-950/20"><div class="flex items-start space-x-2"><!> <div class="space-y-1"><p class="text-sm font-medium text-amber-800 dark:text-amber-200">Important: Save this code!</p> <p class="text-sm text-amber-700 dark:text-amber-300">This is your unique account access code. Store it safely in a password manager
											or secure location.</p></div></div></div></div>`),Ot=_("<!> <!>",1),Ut=_("<!> Account Balance",1),Dt=_("<!> <!>",1),Vt=_('<div class="grid grid-cols-1 gap-4 md:grid-cols-3"><div class="rounded-lg border p-4 text-center"><div class="text-2xl font-bold"> </div> <div class="text-muted-foreground text-sm">Current Balance</div> <!></div> <div class="rounded-lg border p-4 text-center"><div class="text-2xl font-bold">£0.00</div> <div class="text-muted-foreground text-sm">This Month</div></div> <div class="rounded-lg border p-4 text-center"><div class="text-2xl font-bold">0</div> <div class="text-muted-foreground text-sm">Messages</div></div></div> <!>',1),Ht=_("<!> <!>",1),Rt=_("<option> </option>"),qt=_('<div class="grid grid-cols-1 gap-4 md:grid-cols-2"><div><label class="text-sm font-medium">Default Provider</label> <select class="border-border mt-1 w-full rounded-md border px-3 py-2"></select></div> <div><label class="text-sm font-medium">Theme</label> <select class="border-border mt-1 w-full rounded-md border px-3 py-2"><option>Light</option><option>Dark</option><option>System</option></select></div></div>'),Gt=_("<!> <!>",1),Yt=_("<!> Save Settings",1),Jt=_('<div class="space-y-6"><!> <!> <!> <!></div> <div class="flex justify-end"><!></div>',1),Qt=_('<div class="space-y-6"><div class="space-y-4"><!> <div class="flex items-center gap-3"><!> <h1 class="text-2xl font-bold">User Settings</h1></div></div> <!></div>');function Wt(O,b){vt(b,!0);let d=oe(null),l=oe(ut({})),D=oe(!1),W=oe(!1),w=oe(null),q=oe(!1),ve=oe(!1);const Me=[{name:"openai",label:"OpenAI",placeholder:"sk-..."},{name:"anthropic",label:"Anthropic",placeholder:"sk-ant-..."},{name:"google",label:"Google",placeholder:"AI..."},{name:"openrouter",label:"OpenRouter",placeholder:"sk-or-..."}];ft(async()=>{await Ie()});async function Ie(){try{z(D,!0),z(w,null);const a=await Je["user-settings"].$get();if(!a.ok)throw new Error("Failed to load user settings");z(d,await a.json(),!0),z(l,{},!0),Me.forEach(m=>{var G,S;const M=(S=(G=e(d))==null?void 0:G.apiKeys)==null?void 0:S[m.name];e(l)[m.name]={value:M||"",visible:!1,modified:!1}})}catch(a){const m=a instanceof Error?a.message:"Failed to load settings";z(w,m,!0),me(m,{icon:ze}),console.error("Failed to load user settings:",a)}finally{z(D,!1),z(q,!0)}}async function Ze(){var a;try{z(W,!0),z(w,null);const m={};Object.entries(e(l)).forEach(([S,V])=>{V.modified&&V.value&&V.value.trim()!==""&&(m[S]=V.value)});const M={apiKeys:Object.keys(m).length>0?m:void 0,preferences:(a=e(d))==null?void 0:a.preferences};if(!(await Je["user-settings"].$put({json:M})).ok)throw new Error("Failed to save settings");me("Settings saved successfully!",{icon:Ye}),Object.keys(e(l)).forEach(S=>{e(l)[S].modified=!1}),setTimeout(()=>{Ie()},1e3)}catch(m){const M=m instanceof Error?m.message:"Failed to save settings";z(w,M,!0),me(M,{icon:ze}),console.error("Failed to save settings:",m)}finally{z(W,!1)}}function et(a){e(l)[a]&&(e(l)[a].visible=!e(l)[a].visible)}function tt(a,m){e(l)[a]||(e(l)[a]={value:"",visible:!1,modified:!1}),e(l)[a].value=m,e(l)[a].modified=!0}function at(a){return a.replace(/(.{4})/g,"$1-").slice(0,-1)}async function st(){var a;if((a=e(d))!=null&&a.keyLogin)try{await navigator.clipboard.writeText(e(d).keyLogin),z(ve,!0),me("Login code copied to clipboard!",{icon:Ye}),setTimeout(()=>{z(ve,!1)},2e3)}catch(m){console.error("Failed to copy login code:",m),me("Failed to copy login code",{icon:ze})}}var Ke=Qt(),Ee=i(Ke),Ue=i(Ee);pe(Ue,{variant:"ghost",onclick:()=>gt("/"),class:"w-fit",children:(a,m)=>{var M=Ct(),G=o(M);xt(G,{class:"mr-2 h-4 w-4"}),P(),t(a,M)},$$slots:{default:!0}});var De=s(Ue,2),rt=i(De);ht(rt,{class:"h-6 w-6"}),P(2),r(De),r(Ee);var ot=s(Ee,2);{var lt=a=>{var m=R(),M=o(m);g(M,()=>ce,(G,S)=>{S(G,{children:(V,$e)=>{var X=R(),le=o(X);g(le,()=>de,(ee,ue)=>{ue(ee,{class:"flex items-center justify-center py-8",children:(te,ge)=>{var ae=St(),fe=o(ae);Xe(fe,{class:"h-6 w-6 animate-spin"}),P(2),t(te,ae)},$$slots:{default:!0}})}),t(V,X)},$$slots:{default:!0}})}),t(a,m)},nt=(a,m)=>{{var M=S=>{var V=R(),$e=o(V);g($e,()=>ce,(X,le)=>{le(X,{children:(ee,ue)=>{var te=R(),ge=o(te);g(ge,()=>de,(ae,fe)=>{fe(ae,{class:"py-6",children:(he,Ve)=>{var I=At(),j=o(I),N=i(j);kt(N,{class:"h-5 w-5"});var Y=s(N,2),K=i(Y,!0);r(Y),r(j);var E=s(j,2);pe(E,{class:"mt-4",onclick:Ie,children:(A,L)=>{P();var C=Q("Retry");t(A,C)},$$slots:{default:!0}}),be(()=>ye(K,e(w))),t(he,I)},$$slots:{default:!0}})}),t(ee,te)},$$slots:{default:!0}})}),t(S,V)},G=(S,V)=>{{var $e=X=>{var le=Jt(),ee=o(le),ue=i(ee);g(ue,()=>ce,(I,j)=>{j(I,{children:(N,Y)=>{var K=jt(),E=o(K);g(E,()=>Pe,(L,C)=>{C(L,{children:(T,J)=>{var $=Mt(),x=o($);g(x,()=>we,(n,c)=>{c(n,{class:"flex items-center gap-2",children:(p,y)=>{var h=Lt(),u=o(h);mt(u,{class:"h-5 w-5"}),P(),t(p,h)},$$slots:{default:!0}})});var v=s(x,2);g(v,()=>Oe,(n,c)=>{c(n,{children:(p,y)=>{P();var h=Q(`Add your own API keys to use your accounts directly. If no keys are configured, the
						system will use shared keys and deduct from your credits.`);t(p,h)},$$slots:{default:!0}})}),t(T,$)},$$slots:{default:!0}})});var A=s(E,2);g(A,()=>de,(L,C)=>{C(L,{children:(T,J)=>{var $=Ft();He($,21,()=>Me,Re,(x,v)=>{var n=Et(),c=i(n),p=i(c),y=i(p);r(p);var h=s(p,2);{var u=f=>{ke(f,{variant:"secondary",class:"text-xs",children:(F,_e)=>{var ie=It(),it=o(ie);Qe(it,{class:"mr-1 h-3 w-3"}),P(),t(F,ie)},$$slots:{default:!0}})},U=f=>{ke(f,{variant:"outline",class:"text-xs",children:(F,_e)=>{P();var ie=Q("Using system key");t(F,ie)},$$slots:{default:!0}})};H(h,f=>{var F,_e;(F=e(l)[e(v).name])!=null&&F.value&&((_e=e(l)[e(v).name])==null?void 0:_e.value.trim())!==""?f(u):f(U,!1)})}r(c);var k=s(c,2),B=i(k),se=i(B);const Fe=Be(()=>{var f;return(f=e(l)[e(v).name])!=null&&f.visible?"text":"password"}),re=Be(()=>{var f;return((f=e(l)[e(v).name])==null?void 0:f.value)||""});Ge(se,{get type(){return e(Fe)},get placeholder(){return e(v).placeholder},get value(){return e(re)},oninput:f=>tt(e(v).name,f.target.value),class:"pr-10"});var ne=s(se,2);ne.__click=[Kt,et,v];var xe=i(ne);{var je=f=>{bt(f,{class:"text-muted-foreground h-4 w-4"})},Ne=f=>{Pt(f,{class:"text-muted-foreground h-4 w-4"})};H(xe,f=>{var F;(F=e(l)[e(v).name])!=null&&F.visible?f(je):f(Ne,!1)})}r(ne),r(B);var Te=s(B,2);{var Z=f=>{ke(f,{variant:"outline",class:"self-center",children:(F,_e)=>{P();var ie=Q("Modified");t(F,ie)},$$slots:{default:!0}})};H(Te,f=>{var F;(F=e(l)[e(v).name])!=null&&F.modified&&f(Z)})}r(k),r(n),be(()=>ye(y,`${e(v).label??""} API Key`)),t(x,n)}),r($),t(T,$)},$$slots:{default:!0}})}),t(N,K)},$$slots:{default:!0}})});var te=s(ue,2);{var ge=I=>{var j=R(),N=o(j);g(N,()=>ce,(Y,K)=>{K(Y,{children:(E,A)=>{var L=Ot(),C=o(L);g(C,()=>Pe,(J,$)=>{$(J,{children:(x,v)=>{var n=Tt(),c=o(n);g(c,()=>we,(y,h)=>{h(y,{class:"flex items-center gap-2",children:(u,U)=>{var k=Nt(),B=o(k);We(B,{class:"h-5 w-5"}),P(),t(u,k)},$$slots:{default:!0}})});var p=s(c,2);g(p,()=>Oe,(y,h)=>{h(y,{children:(u,U)=>{P();var k=Q("Use this code to access your account from any device. Keep it safe and secure!");t(u,k)},$$slots:{default:!0}})}),t(x,n)},$$slots:{default:!0}})});var T=s(C,2);g(T,()=>de,(J,$)=>{$(J,{children:(x,v)=>{var n=zt(),c=i(n),p=s(i(c),2),y=i(p);const h=Be(()=>at(e(d).keyLogin));Ge(y,{get value(){return e(h)},readonly:!0,class:"bg-muted text-center font-mono"});var u=s(y,2);pe(u,{variant:"outline",size:"sm",onclick:st,get disabled(){return e(ve)},children:(re,ne)=>{var xe=R(),je=o(xe);{var Ne=Z=>{Qe(Z,{class:"h-4 w-4 text-green-500"})},Te=Z=>{yt(Z,{class:"h-4 w-4"})};H(je,Z=>{e(ve)?Z(Ne):Z(Te,!1)})}t(re,xe)},$$slots:{default:!0}}),r(p);var U=s(p,2);{var k=re=>{var ne=Bt();t(re,ne)};H(U,re=>{e(ve)&&re(k)})}r(c);var B=s(c,2),se=i(B),Fe=i(se);We(Fe,{class:"mt-0.5 h-4 w-4 flex-shrink-0 text-amber-600 dark:text-amber-400"}),P(2),r(se),r(B),r(n),t(x,n)},$$slots:{default:!0}})}),t(E,L)},$$slots:{default:!0}})}),t(I,j)};H(te,I=>{e(d).keyLogin&&I(ge)})}var ae=s(te,2);g(ae,()=>ce,(I,j)=>{j(I,{children:(N,Y)=>{var K=Ht(),E=o(K);g(E,()=>Pe,(L,C)=>{C(L,{children:(T,J)=>{var $=Dt(),x=o($);g(x,()=>we,(n,c)=>{c(n,{class:"flex items-center gap-2",children:(p,y)=>{var h=Ut(),u=o(h);$t(u,{class:"h-5 w-5"}),P(),t(p,h)},$$slots:{default:!0}})});var v=s(x,2);g(v,()=>Oe,(n,c)=>{c(n,{children:(p,y)=>{P();var h=Q("Credits are used when system API keys are used (no user keys configured)");t(p,h)},$$slots:{default:!0}})}),t(T,$)},$$slots:{default:!0}})});var A=s(E,2);g(A,()=>de,(L,C)=>{C(L,{children:(T,J)=>{var $=Vt(),x=o($),v=i(x),n=i(v),c=i(n);r(n);var p=s(n,4);{var y=u=>{ke(u,{variant:"destructive",class:"mt-2",children:(U,k)=>{P();var B=Q("Low balance");t(U,B)},$$slots:{default:!0}})};H(p,u=>{e(d).credits<=500&&u(y)})}r(v),P(4),r(x);var h=s(x,2);pe(h,{class:"mt-4 w-full",children:(u,U)=>{P();var k=Q("Add Credits");t(u,k)},$$slots:{default:!0}}),be(u=>ye(c,`£${u??""}`),[()=>(e(d).credits/100).toFixed(2)]),t(T,$)},$$slots:{default:!0}})}),t(N,K)},$$slots:{default:!0}})});var fe=s(ae,2);g(fe,()=>ce,(I,j)=>{j(I,{children:(N,Y)=>{var K=Gt(),E=o(K);g(E,()=>Pe,(L,C)=>{C(L,{children:(T,J)=>{var $=R(),x=o($);g(x,()=>we,(v,n)=>{n(v,{children:(c,p)=>{P();var y=Q("Preferences");t(c,y)},$$slots:{default:!0}})}),t(T,$)},$$slots:{default:!0}})});var A=s(E,2);g(A,()=>de,(L,C)=>{C(L,{class:"space-y-4",children:(T,J)=>{var $=qt(),x=i($),v=s(i(x),2);He(v,21,()=>Me,Re,(u,U)=>{var k=Rt(),B={},se=i(k,!0);r(k),be(()=>{B!==(B=e(U).name)&&(k.value=(k.__value=e(U).name)??""),ye(se,e(U).label)}),t(u,k)}),r(v),r(x);var n=s(x,2),c=s(i(n),2),p=i(c);p.value=p.__value="light";var y=s(p);y.value=y.__value="dark";var h=s(y);h.value=h.__value="system",r(c),r(n),r($),qe(v,()=>e(d).preferences.defaultProvider,u=>e(d).preferences.defaultProvider=u),qe(c,()=>e(d).preferences.theme,u=>e(d).preferences.theme=u),t(T,$)},$$slots:{default:!0}})}),t(N,K)},$$slots:{default:!0}})}),r(ee);var he=s(ee,2),Ve=i(he);pe(Ve,{onclick:Ze,get disabled(){return e(W)},children:(I,j)=>{var N=Yt(),Y=o(N);{var K=A=>{Xe(A,{class:"mr-2 h-4 w-4 animate-spin"})},E=A=>{wt(A,{class:"mr-2 h-4 w-4"})};H(Y,A=>{e(W)?A(K):A(E,!1)})}P(),t(I,N)},$$slots:{default:!0}}),r(he),t(X,le)};H(S,X=>{e(d)&&X($e)},V)}};H(a,S=>{e(w)?S(M):S(G,!1)},m)}};H(ot,a=>{e(D)?a(lt):a(nt,!1)})}r(Ke),t(O,Ke),_t()}dt(["click"]);var Xt=_('<div class="container mx-auto max-w-4xl px-4 py-6"><!></div>');function ua(O){var b=Xt();ct(l=>{pt.title="Settings - DuraChat"});var d=i(b);Wt(d,{}),r(b),t(O,b)}export{ua as component};
