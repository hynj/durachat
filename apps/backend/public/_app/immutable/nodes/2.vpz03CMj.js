const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/D9TWUjiN.js","../chunks/D0RciOE6.js","../chunks/Dp1pzeXC.js","../chunks/B6bYGZD0.js"])))=>i.map(i=>d[i]);
var Ct=Object.defineProperty;var St=(c,t,a)=>t in c?Ct(c,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[t]=a;var Me=(c,t,a)=>St(c,typeof t!="symbol"?t+"":t,a);import{c as ne,a as u,f as x,s as ue,t as Ee,d as Fe,v as Ie,w as Mt}from"../chunks/BDdIJgRh.js";import{aR as Tt,f as E,p as ke,d as p,Q as It,r as v,b as $e,s as I,a as Te,o as He,c as o,g as e,K as We,e as m,t as de,S as ve,n as fe,aS as je,aT as At,aU as Nt}from"../chunks/Bcdcg6QJ.js";import{i as G}from"../chunks/CGJFYSJu.js";import{_ as Oe}from"../chunks/Dp1pzeXC.js";import{l as _e,s as xe,p as V,r as Lt,d as Ve,c as Ce,b as Et,a as Wt}from"../chunks/HP_sVpL7.js";import{p as Rt}from"../chunks/BXzyF5gP.js";import{g as Ye}from"../chunks/Bwa0UiRW.js";import{d as Re,a as Ue,b as et,u as tt,g as vt,e as Ft,v as zt,f as Dt,h as Kt}from"../chunks/D9TWUjiN.js";import{I as jt,V as Ot,M as Ut,F as Bt,a as Gt,u as Ht,A as Vt,C as Qt}from"../chunks/vHtDAXiY.js";import{I as gt,C as ft,t as Be,a as nt,b as qt}from"../chunks/af7Bwi91.js";import{I as ye,s as be,a as Jt,c as Zt,d as Xt,B as pe,e as Ae,h as Yt,i as Ge,j as en}from"../chunks/BNH1bgBz.js";import{B as ot,a as tn,d as pt,e as mt,C as nn,b as on,c as rn,K as rt}from"../chunks/1GFsE5rG.js";import{c as ht}from"../chunks/B6bYGZD0.js";import{L as at}from"../chunks/BQlalapJ.js";import"../chunks/DU4ySZei.js";import{S as an,X as st,s as it}from"../chunks/CavqSQw7.js";const sn=Tt;function ln(c,t){const a=_e(t,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"M12 7v14"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"}]];ye(c,xe({name:"book-open"},()=>a,{get iconNode(){return l},children:(s,i)=>{var r=ne(),g=E(r);be(g,t,"default",{}),u(s,r)},$$slots:{default:!0}}))}function dn(c,t){const a=_e(t,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18"}]];ye(c,xe({name:"brain"},()=>a,{get iconNode(){return l},children:(s,i)=>{var r=ne(),g=E(r);be(g,t,"default",{}),u(s,r)},$$slots:{default:!0}}))}function Qe(c,t){const a=_e(t,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"m6 9 6 6 6-6"}]];ye(c,xe({name:"chevron-down"},()=>a,{get iconNode(){return l},children:(s,i)=>{var r=ne(),g=E(r);be(g,t,"default",{}),u(s,r)},$$slots:{default:!0}}))}function cn(c,t){const a=_e(t,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"m16 18 6-6-6-6"}],["path",{d:"m8 6-6 6 6 6"}]];ye(c,xe({name:"code"},()=>a,{get iconNode(){return l},children:(s,i)=>{var r=ne(),g=E(r);be(g,t,"default",{}),u(s,r)},$$slots:{default:!0}}))}function lt(c,t){const a=_e(t,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"}],["path",{d:"M9 18c-4.51 2-5-2-7-2"}]];ye(c,xe({name:"github"},()=>a,{get iconNode(){return l},children:(s,i)=>{var r=ne(),g=E(r);be(g,t,"default",{}),u(s,r)},$$slots:{default:!0}}))}function un(c,t){const a=_e(t,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"}],["path",{d:"M9 18h6"}],["path",{d:"M10 22h4"}]];ye(c,xe({name:"lightbulb"},()=>a,{get iconNode(){return l},children:(s,i)=>{var r=ne(),g=E(r);be(g,t,"default",{}),u(s,r)},$$slots:{default:!0}}))}function dt(c,t){const a=_e(t,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"m10 17 5-5-5-5"}],["path",{d:"M15 12H3"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}]];ye(c,xe({name:"log-in"},()=>a,{get iconNode(){return l},children:(s,i)=>{var r=ne(),g=E(r);be(g,t,"default",{}),u(s,r)},$$slots:{default:!0}}))}function ct(c,t){const a=_e(t,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"}]];ye(c,xe({name:"message-circle"},()=>a,{get iconNode(){return l},children:(s,i)=>{var r=ne(),g=E(r);be(g,t,"default",{}),u(s,r)},$$slots:{default:!0}}))}function vn(c,t){const a=_e(t,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551"}]];ye(c,xe({name:"paperclip"},()=>a,{get iconNode(){return l},children:(s,i)=>{var r=ne(),g=E(r);be(g,t,"default",{}),u(s,r)},$$slots:{default:!0}}))}function gn(c,t){const a=_e(t,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];ye(c,xe({name:"send"},()=>a,{get iconNode(){return l},children:(s,i)=>{var r=ne(),g=E(r);be(g,t,"default",{}),u(s,r)},$$slots:{default:!0}}))}function fn(c,t){const a=_e(t,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z"}],["path",{d:"M20 3v4"}],["path",{d:"M22 5h-4"}],["path",{d:"M4 17v2"}],["path",{d:"M5 18H3"}]];ye(c,xe({name:"sparkles"},()=>a,{get iconNode(){return l},children:(s,i)=>{var r=ne(),g=E(r);be(g,t,"default",{}),u(s,r)},$$slots:{default:!0}}))}function ut(c,t){const a=_e(t,["children","$$slots","$$events","$$legacy"]),l=[["path",{d:"M12 3v12"}],["path",{d:"m17 8-5-5-5 5"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}]];ye(c,xe({name:"upload"},()=>a,{get iconNode(){return l},children:(s,i)=>{var r=ne(),g=E(r);be(g,t,"default",{}),u(s,r)},$$slots:{default:!0}}))}class pn{constructor(t="ws://localhost:5787"){Me(this,"ws",null);Me(this,"url");Me(this,"handlers",new Map);Me(this,"reconnectAttempts",0);Me(this,"maxReconnectAttempts",5);Me(this,"reconnectDelay",1e3);Me(this,"conversationId",null);{const a=new URL("/test/ws",location.href);a.protocol="wss",this.url=a.toString()}}connect(t){return new Promise((a,l)=>{try{const s=new URL(this.url);t&&(s.searchParams.set("conversationId",t),this.conversationId=t),s.searchParams.set("sessionId",`session-${Date.now()}`),this.ws=new WebSocket(s.toString()),this.ws.onopen=()=>{this.reconnectAttempts=0,this.emit("connected",{type:"connected"}),a()},this.ws.onmessage=i=>{try{const r=JSON.parse(i.data);this.emit(r.type,r),r.type==="conversation_created"&&r.conversationId&&(this.conversationId=r.conversationId)}catch(r){console.error("Failed to parse WebSocket message:",r)}},this.ws.onerror=i=>{console.error("WebSocket error:",i),this.emit("error",{type:"error",message:"Connection error"}),l(i)},this.ws.onclose=()=>{this.emit("disconnected",{type:"disconnected"}),this.handleReconnect()}}catch(s){l(s)}})}handleReconnect(){if(this.reconnectAttempts<this.maxReconnectAttempts){this.reconnectAttempts++;const t=this.reconnectDelay*Math.pow(2,this.reconnectAttempts-1);setTimeout(()=>{console.log(`Reconnecting... attempt ${this.reconnectAttempts}`),this.connect(this.conversationId||void 0)},t)}}startChat(t,a,l,s,i,r){var g,A;if(console.log("ðŸš€ ChatClient.startChat called with:",{prompt:t,conversationId:a,messageId:l,provider:s,model:i,reasoningEffort:r}),console.log("ðŸ”— WebSocket state:",(g=this.ws)==null?void 0:g.readyState,"Open?",((A=this.ws)==null?void 0:A.readyState)===WebSocket.OPEN),this.ws&&this.ws.readyState===WebSocket.OPEN){const N={type:"start_chat",prompt:t,conversationId:a||this.conversationId,messageId:l,provider:s,model:i,reasoningEffort:r};console.log("ðŸ“¤ Sending WebSocket message:",N),this.ws.send(JSON.stringify(N))}else throw console.error("âŒ WebSocket not connected - cannot send message"),new Error("WebSocket not connected")}switchConversation(t){if(console.log("ðŸ”„ ChatClient.switchConversation called with:",t),this.ws&&this.ws.readyState===WebSocket.OPEN){const a={type:"switch_conversation",conversationId:t};console.log("ðŸ“¤ Sending switch_conversation message:",a),this.ws.send(JSON.stringify(a))}else throw console.error("âŒ WebSocket not connected - cannot switch conversation"),new Error("WebSocket not connected")}deleteConversation(t){if(console.log("ðŸ—‘ï¸ ChatClient.deleteConversation called with:",t),this.ws&&this.ws.readyState===WebSocket.OPEN){const a={type:"delete_conversation",conversationId:t};console.log("ðŸ“¤ Sending delete_conversation message:",a),this.ws.send(JSON.stringify(a))}else throw console.error("âŒ WebSocket not connected - cannot delete conversation"),new Error("WebSocket not connected")}ping(){this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify({type:"ping"}))}on(t,a){this.handlers.has(t)||this.handlers.set(t,[]),this.handlers.get(t).push(a)}off(t,a){const l=this.handlers.get(t);if(l){const s=l.indexOf(a);s>-1&&l.splice(s,1)}}emit(t,a){const l=this.handlers.get(t);l&&l.forEach(s=>s(a))}disconnect(){this.ws&&(this.ws.close(),this.ws=null)}getConversationId(){return this.conversationId}isConnected(){return this.ws?this.ws.readyState===WebSocket.OPEN:!1}}var mn=x("<div><!></div>");function hn(c,t){ke(t,!0);let a=V(t,"ref",15,null),l=Lt(t,["$$slots","$$events","$$legacy","ref","class","children"]);var s=mn();Jt(s,r=>({"data-slot":"card-footer",class:r,...l}),[()=>Zt("flex items-center px-6 [.border-t]:pt-6",t.class)]);var i=p(s);Xt(i,()=>t.children??It),v(s),Ve(s,r=>a(r),()=>a()),u(c,s),$e()}const wt={google:{name:"google",displayName:"Google Gemini",defaultModel:"gemini-2.5-flash-preview-05-20",supportedAttachmentTypes:["image/png","image/jpeg","image/gif","image/webp","application/pdf","text/plain","text/html","audio/wav","audio/mp3","audio/mpeg","video/mp4","video/mpeg","video/quicktime"],models:[{id:"gemini-2.5-pro-preview-06-05",displayName:"Gemini 2.5 Pro",description:"Most capable model for complex reasoning tasks",contextWindow:1e6,inputPricing:"$1.25 / 1M tokens (<=200k), $2.50 / 1M tokens (>200k)",outputPricing:"$10.00 / 1M tokens (<=200k), $15.00 / 1M tokens (>200k)",promptTokenCostPer1K:.125,completionTokenCostPer1K:1,supportsThinking:!0},{id:"gemini-2.5-flash-preview-05-20",displayName:"Gemini 2.5 Flash (Thinking)",description:"Fast model with advanced reasoning capabilities",contextWindow:1e6,inputPricing:"$0.30 / 1M tokens (text/image/video), $1.00 / 1M tokens (audio)",outputPricing:"$2.50 / 1M tokens",promptTokenCostPer1K:.03,completionTokenCostPer1K:.25,supportsThinking:!0},{id:"gemini-2.5-flash-preview-05-20-non-thinking",displayName:"Gemini 2.5 Flash (Standard)",description:"Fast and cost-effective model for most tasks",contextWindow:1e6,inputPricing:"$0.30 / 1M tokens (text/image/video), $1.00 / 1M tokens (audio)",outputPricing:"$2.50 / 1M tokens",promptTokenCostPer1K:.03,completionTokenCostPer1K:.25,supportsThinking:!1},{id:"gemini-2.5-flash-lite-preview-06-17",displayName:"Gemini 2.5 Flash Lite",description:"Lower cost model for large scale processing and high volume tasks",contextWindow:1e6,inputPricing:"$0.10 / 1M tokens",outputPricing:"$0.40 / 1M tokens",promptTokenCostPer1K:.01,completionTokenCostPer1K:.04,supportsThinking:!0}]},openai:{name:"openai",displayName:"OpenAI GPT",defaultModel:"gpt-4o",supportedAttachmentTypes:["image/png","image/jpeg","image/gif","image/webp"],models:[{id:"gpt-4o",displayName:"GPT-4o",description:"Most advanced multimodal model",contextWindow:128e3,supportsThinking:!1},{id:"gpt-4o-mini",displayName:"GPT-4o Mini",description:"Affordable and intelligent small model",contextWindow:128e3,supportsThinking:!1},{id:"gpt-4.1",displayName:"GPT-4.1",description:"Smartest model for complex tasks",contextWindow:128e3,inputPricing:"$2.00 / 1M tokens",outputPricing:"$8.00 / 1M tokens",promptTokenCostPer1K:.2,completionTokenCostPer1K:.8,supportsThinking:!1},{id:"gpt-4.1-mini",displayName:"GPT-4.1 Mini",description:"Affordable model balancing speed and intelligence",contextWindow:128e3,inputPricing:"$0.40 / 1M tokens",outputPricing:"$1.60 / 1M tokens",promptTokenCostPer1K:.04,completionTokenCostPer1K:.16,supportsThinking:!1},{id:"gpt-4.1-nano",displayName:"GPT-4.1 Nano",description:"Fastest, most cost-effective model for low-latency tasks",contextWindow:128e3,inputPricing:"$0.100 / 1M tokens",outputPricing:"$0.400 / 1M tokens",promptTokenCostPer1K:.01,completionTokenCostPer1K:.04,supportsThinking:!1},{id:"o3-2025-04-16",displayName:"OpenAI o3",description:"Most powerful reasoning model with leading performance on coding, math, science, and vision",contextWindow:128e3,inputPricing:"$2.00 / 1M tokens",outputPricing:"$8.00 / 1M tokens",promptTokenCostPer1K:.2,completionTokenCostPer1K:.8,supportsThinking:!0,supportsReasoningEffort:!0,reasoningEffortLevels:["low","medium","high"],defaultReasoningEffort:"medium"},{id:"o4-mini-2025-04-16",displayName:"OpenAI o4-mini",description:"Faster, cost-efficient reasoning model delivering strong performance on math, coding and vision",contextWindow:128e3,inputPricing:"$1.100 / 1M tokens",outputPricing:"$4.400 / 1M tokens",promptTokenCostPer1K:.11,completionTokenCostPer1K:.44,supportsThinking:!0,supportsReasoningEffort:!0,reasoningEffortLevels:["low","medium","high"],defaultReasoningEffort:"medium"}]},anthropic:{name:"anthropic",displayName:"Anthropic Claude",defaultModel:"claude-sonnet-4-20250514",supportedAttachmentTypes:["image/png","image/jpeg","image/gif","image/webp","application/pdf","text/plain","text/html"],models:[{id:"claude-sonnet-4-20250514",displayName:"Claude Sonnet 4",description:"Latest generation Sonnet model",contextWindow:2e5,inputPricing:"$3.00 / 1M tokens",outputPricing:"$15.00 / 1M tokens",promptTokenCostPer1K:.3,completionTokenCostPer1K:1.5,supportsThinking:!0},{id:"claude-opus-4-20250514",displayName:"Claude Opus 4",description:"Most powerful Claude model for complex tasks",contextWindow:2e5,inputPricing:"$15.00 / 1M tokens",outputPricing:"$75.00 / 1M tokens",promptTokenCostPer1K:1.5,completionTokenCostPer1K:7.5,supportsThinking:!0},{id:"claude-3-5-sonnet-20241022",displayName:"Claude 3.5 Sonnet",description:"Balanced model for most tasks",contextWindow:2e5,inputPricing:"$3.00 / 1M tokens",outputPricing:"$15.00 / 1M tokens",promptTokenCostPer1K:.3,completionTokenCostPer1K:1.5,supportsThinking:!1},{id:"claude-3-5-haiku-20241022",displayName:"Claude 3.5 Haiku",description:"Fast and efficient model",contextWindow:2e5,inputPricing:"$0.80 / MTok",outputPricing:"$4.00 / MTok",promptTokenCostPer1K:.08,completionTokenCostPer1K:.4,supportsThinking:!1},{id:"claude-3-opus-20240229",displayName:"Claude 3 Opus",description:"Previous generation flagship model",contextWindow:2e5,inputPricing:"$15.00 / 1M tokens",outputPricing:"$75.00 / 1M tokens",promptTokenCostPer1K:1.5,completionTokenCostPer1K:7.5,supportsThinking:!1}]},openrouter:{name:"openrouter",displayName:"OpenRouter",defaultModel:"gpt-4o",supportedAttachmentTypes:["image/png","image/jpeg","image/gif","image/webp"],models:[{id:"openai/o4-mini",displayName:"OpenRouter GPT-4o Mini",description:"Affordable and intelligent small model",contextWindow:128e3,inputPricing:"$1.100 / 1M tokens",outputPricing:"$4.400 / 1M tokens",promptTokenCostPer1K:.11,completionTokenCostPer1K:.44,supportsThinking:!1},{id:"qwen/qwen3-32b:free",displayName:"OpenRouter Qwen 32B",description:"Large model with advanced capabilities",contextWindow:2e5,inputPricing:"$0.002 / 1M tokens",outputPricing:"$0.002 / 1M tokens",promptTokenCostPer1K:.002,completionTokenCostPer1K:.002,supportsThinking:!1},{id:"google/gemini-2.0-flash-exp:free",displayName:"OpenRouter Gemini 2.0 Flash",description:"Large model with advanced capabilities",contextWindow:2e5,inputPricing:"$0.002 / 1M tokens",outputPricing:"$0.002 / 1M tokens",promptTokenCostPer1K:.002,completionTokenCostPer1K:.002,supportsThinking:!1}]}};function _t(){return Object.values(wt)}function wn(c){return wt[c]}function _n(c,t){const a=wn(c),l=a==null?void 0:a.models.find(s=>s.id===t);return(l==null?void 0:l.displayName)||t}function xn(){return _t().map(c=>({name:c.name,displayName:c.displayName,models:c.models.map(t=>t.id),defaultModel:c.defaultModel}))}function qe(c){for(const t of _t()){const a=t.models.find(l=>l.id===c);if(a)return a}return null}function yn(c){const t=qe(c);return(t==null?void 0:t.supportsReasoningEffort)||!1}function bn(c){const t=qe(c);return(t==null?void 0:t.reasoningEffortLevels)||[]}function kn(c){const t=qe(c);return(t==null?void 0:t.defaultReasoningEffort)||null}class $n{async getProviders(){return xn()}async switchProvider(t,a,l){if(!t)return console.log("ðŸ”„ Provider switch for new conversation - will use when creating conversation"),Promise.resolve();try{const s=await ht.test["switch-provider"].$post({json:{conversationId:t,provider:a,model:l}});if(!s.ok){const r=await s.json().catch(()=>({error:s.statusText}));throw new Error(r.error||`Failed to switch provider: ${s.statusText}`)}const i=await s.json();if(!i.success)throw new Error(i.message||"Failed to switch provider")}catch(s){throw console.error("Error switching provider:",s),s}}getModelDisplayName(t,a){return _n(t,a)}}const Le=new $n;var Pn=x("<span> </span> <!>",1),Cn=x("<!> ",1),Sn=x('<div class="flex items-center gap-1"><!> <!></div>'),Mn=x('<div class="flex items-center justify-center py-2"><!> <span class="ml-2 text-xs">Loading...</span></div>'),Tn=x('<div class="py-2 text-center"><p class="text-destructive text-xs"> </p> <!></div>'),In=x('<div class="py-2 text-center"><p class="text-muted-foreground text-xs">No providers available</p></div>'),An=x('<span class="truncate"> </span> <!>',1),Nn=x('<div class="py-2 text-center"><p class="text-muted-foreground text-xs">No models found</p></div>'),Ln=x('<div class="relative mb-2"><!> <!></div> <div class="space-y-2"><!> <!></div>',1),En=x('<div class="relative" data-provider-selector=""><div class="flex items-center gap-2"><!> <!></div> <!></div>');function Wn(c,t){ke(t,!0);let a=V(t,"currentProvider",3,"anthropic"),l=V(t,"currentModel",3,"claude-sonnet-4-20250514"),s=V(t,"disabled",3,!1),i=I(Te([])),r=I(!1),g=I(null),A=I(!1),N=I(!1),b=I("");He(async()=>{console.log("on mount"),await L()});async function L(){console.log("laoding providers");try{o(r,!0),o(g,null),o(i,await Le.getProviders(),!0),console.log(e(i))}catch(_){o(g,_ instanceof Error?_.message:"Failed to load providers",!0),console.error("Failed to load providers:",_)}finally{o(r,!1)}}async function W(_,$){var k;if(!(e(N)||s()))try{o(N,!0),o(g,null),t.conversationId&&await Le.switchProvider(t.conversationId,_,$),(k=t.onProviderChange)==null||k.call(t,_,$),o(A,!1)}catch(S){o(g,S instanceof Error?S.message:"Failed to switch provider",!0),console.error("Failed to switch provider:",S)}finally{o(N,!1)}}function h(){const _=e(i).find($=>$.name===a());return{providerName:(_==null?void 0:_.displayName)||a(),modelName:_?Le.getModelDisplayName(a(),l()):l()}}let w=ve(()=>e(i).map(_=>({..._,models:_.models.filter($=>{if(!e(b).trim())return!0;const k=e(b).toLowerCase(),S=Le.getModelDisplayName(_.name,$).toLowerCase(),f=_.displayName.toLowerCase();return S.includes(k)||f.includes(k)||$.toLowerCase().includes(k)})})).filter(_=>_.models.length>0));We(()=>{function _($){const k=$.target;k!=null&&k.closest("[data-provider-selector]")||o(A,!1)}if(e(A))return document.addEventListener("click",_),()=>document.removeEventListener("click",_)});var C=En(),R=p(C),K=p(R);pe(K,{variant:"ghost",size:"sm",class:"h-8 justify-between gap-1 px-2 text-xs font-medium",onclick:()=>o(A,!e(A)),get disabled(){return s()},children:(_,$)=>{var k=Pn(),S=E(k),f=p(S,!0);v(S);var y=m(S,2);{var M=D=>{at(D,{class:"h-3 w-3 animate-spin"})},F=D=>{const Y=ve(()=>e(A)?"rotate-180":"");Qe(D,{get class(){return`h-3 w-3 ${e(Y)??""} transition-transform`}})};G(y,D=>{e(N)?D(M):D(F,!1)})}de(D=>ue(f,D),[()=>e(r)?"Loading...":h().modelName]),u(_,k)},$$slots:{default:!0}});var Q=m(K,2);{var U=_=>{var $=Sn(),k=p($);ot(k,{variant:"outline",class:"h-6 px-1.5 text-xs",children:(y,M)=>{var F=Cn(),D=E(F);tn(D,{class:"mr-1 h-2.5 w-2.5"});var Y=m(D);de(X=>ue(Y,` $${X??""}`),[()=>(t.userSettings.credits/100).toFixed(2)]),u(y,F)},$$slots:{default:!0}});var S=m(k,2);{var f=y=>{ot(y,{variant:"destructive",class:"h-6 px-1.5 text-xs",children:(M,F)=>{fe();var D=Ee("Low");u(M,D)},$$slots:{default:!0}})};G(S,y=>{t.userSettings.credits<=10&&y(f)})}v($),u(_,$)};G(Q,_=>{t.userSettings&&_(U)})}v(R);var z=m(R,2);{var q=_=>{var $=ne(),k=E($);Ce(k,()=>mt,(S,f)=>{f(S,{class:"absolute bottom-full left-0 z-[100] mb-2 w-64 shadow-lg",children:(y,M)=>{var F=ne(),D=E(F);Ce(D,()=>pt,(Y,X)=>{X(Y,{class:"px-3 pt-0 pb-3",children:(he,oe)=>{var B=ne(),se=E(B);{var J=ee=>{var j=Mn(),H=p(j);at(H,{class:"h-3 w-3 animate-spin"}),fe(2),v(j),u(ee,j)},me=(ee,j)=>{{var H=te=>{var re=Tn(),ce=p(re),ae=p(ce,!0);v(ce);var ie=m(ce,2);pe(ie,{variant:"outline",size:"sm",class:"mt-1 h-6 text-xs",onclick:L,children:(Pe,le)=>{fe();var we=Ee("Retry");u(Pe,we)},$$slots:{default:!0}}),v(re),de(()=>ue(ae,e(g))),u(te,re)},Z=(te,re)=>{{var ce=ie=>{var Pe=In();u(ie,Pe)},ae=ie=>{var Pe=Ln(),le=E(Pe),we=p(le);an(we,{class:"text-muted-foreground absolute top-1/2 left-2 h-3 w-3 -translate-y-1/2"});var n=m(we,2);gt(n,{placeholder:"Search models...",class:"h-7 pl-7 text-xs",get value(){return e(b)},set value(T){o(b,T,!0)}}),v(le);var d=m(le,2),P=p(d);Ae(P,17,()=>e(w),T=>T.name,(T,Se)=>{var Je=ne(),xt=E(Je);Ae(xt,16,()=>e(Se).models,ze=>ze,(ze,De)=>{const Ze=ve(()=>a()===e(Se).name&&l()===De),yt=ve(()=>e(Ze)?"default":"ghost");pe(ze,{get variant(){return e(yt)},size:"sm",class:"h-6 w-full justify-start px-2 text-xs",onclick:()=>W(e(Se).name,De),get disabled(){return e(N)},children:(bt,Wo)=>{var Xe=An(),Ke=E(Xe),kt=p(Ke,!0);v(Ke);var $t=m(Ke,2);{var Pt=Ne=>{ft(Ne,{class:"ml-auto h-3 w-3"})};G($t,Ne=>{e(Ze)&&Ne(Pt)})}de(Ne=>ue(kt,Ne),[()=>Le.getModelDisplayName(e(Se).name,De)]),u(bt,Xe)},$$slots:{default:!0}})}),u(T,Je)});var O=m(P,2);{var ge=T=>{var Se=Nn();u(T,Se)};G(O,T=>{e(w).length===0&&T(ge)})}v(d),u(ie,Pe)};G(te,ie=>{e(i).length===0?ie(ce):ie(ae,!1)},re)}};G(ee,te=>{e(g)?te(H):te(Z,!1)},j)}};G(se,ee=>{e(r)?ee(J):ee(me,!1)})}u(he,B)},$$slots:{default:!0}})}),u(y,F)},$$slots:{default:!0}})}),u(_,$)};G(z,_=>{e(A)&&_(q)})}v(C),u(c,C),$e()}var Rn=x('<!> <span class="hidden sm:inline"> </span> <!>',1),Fn=(c,t,a)=>t(a),zn=x('<div class="h-2 w-2 rounded-full bg-primary"></div>'),Dn=x('<button type="button" class="flex w-full items-center justify-between rounded-sm px-2 py-1.5 text-sm hover:bg-accent hover:text-accent-foreground"><span> </span> <!></button>'),Kn=x('<div class="absolute bottom-full left-0 z-50 min-w-[120px] mb-1 rounded-md border bg-card shadow-md p-1"></div>'),jn=x('<div class="relative"><!> <!></div>');function On(c,t){ke(t,!0);let a=V(t,"modelId",3,"");V(t,"provider",3,"");let l=V(t,"reasoningEffort",15,"medium"),s=V(t,"onReasoningEffortChange",3,()=>{}),i=V(t,"disabled",3,!1),r=ve(()=>yn(a())),g=ve(()=>bn(a())),A=ve(()=>kn(a())),N=I(!1);We(()=>{e(r)&&!l()&&e(A)&&(l(e(A)),s()(l()))});function b(C){l(C),s()(C),o(N,!1)}function L(C){return C.charAt(0).toUpperCase()+C.slice(1)}var W=ne(),h=E(W);{var w=C=>{var R=jn(),K=p(R);pe(K,{variant:"ghost",size:"sm",class:"h-8 px-2 text-xs",onclick:()=>o(N,!e(N)),get disabled(){return i()},children:(z,q)=>{var _=Rn(),$=E(_);dn($,{class:"h-3 w-3 mr-1"});var k=m($,2),S=p(k,!0);v(k);var f=m(k,2);Qe(f,{class:"h-3 w-3 ml-1"}),de(y=>ue(S,y),[()=>L(l())]),u(z,_)},$$slots:{default:!0}});var Q=m(K,2);{var U=z=>{var q=Kn();Ae(q,20,()=>e(g),_=>_,(_,$)=>{var k=Dn();k.__click=[Fn,b,$];var S=p(k),f=p(S,!0);v(S);var y=m(S,2);{var M=F=>{var D=zn();u(F,D)};G(y,F=>{l()===$&&F(M)})}v(k),de(F=>ue(f,F),[()=>L($)]),u(_,k)}),v(q),u(z,q)};G(Q,z=>{e(N)&&z(U)})}v(R),u(C,R)};G(h,C=>{e(r)&&e(g).length>0&&C(w)})}u(c,W),$e()}Fe(["click"]);async function Un(c,t){const a=c.target;a.files&&await t(Array.from(a.files))}var Bn=x("<!> Attach",1),Gn=x('<div class="bg-muted/20 flex items-center gap-2 rounded p-2 text-xs"><!> <div class="min-w-0 flex-1"><div class="truncate font-medium"> </div> <div class="text-muted-foreground"> </div></div> <!></div>'),Hn=x('<div class="mt-3"><div class="mb-1 flex items-center justify-between text-xs"><span>Uploading...</span> <span> </span></div> <div class="bg-muted h-2 w-full rounded-full"><div class="bg-primary h-2 rounded-full transition-all duration-300"></div></div></div>'),Vn=x("<!> ",1),Qn=x('<div class="mt-3 flex gap-2"><!></div>'),qn=x('<div class="bg-background border-border absolute bottom-full left-0 z-50 mb-2 w-80 rounded-lg border p-3 shadow-lg"><div class="mb-3 flex items-center justify-between"><h4 class="text-sm font-medium">Selected Files</h4> <!></div> <div class="max-h-40 space-y-2 overflow-y-auto"></div> <!></div>'),Jn=x('<div class="bg-background/80 fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm"><div class="border-primary bg-background rounded-lg border-2 border-dashed p-8 text-center"><!> <p class="text-lg font-medium">Drop files here to attach</p> <p class="text-muted-foreground text-sm">Up to 10MB per file</p></div></div>'),Zn=x('<div class="relative"><input type="file" multiple class="hidden"/> <!> <!> <!></div>');function Xn(c,t){ke(t,!0);let a,l=I(!1),s=I(!1),i=I(0),r=I(Te([])),g=I(!1);const A=10*1024*1024,N=["image/*","text/*","application/pdf","application/json","application/xml","application/zip","video/*","audio/*"];function b(){a==null||a.click()}async function L(f){const y=f.filter(M=>M.size>A?(Be(`File "${M.name}" is too large. Maximum size is 10MB.`,{icon:nt}),!1):!0);y.length>0&&(t.ensureMessageId&&await t.ensureMessageId(),o(r,[...e(r),...y],!0),o(g,!0))}function W(f){o(r,e(r).filter((y,M)=>M!==f),!0),e(r).length===0&&o(g,!1)}async function h(){if(!(!t.conversationId||e(r).length===0)){o(s,!0),o(i,0);try{const f=e(r).map(async(M,F)=>{const D=await Ht(M,t.conversationId);return o(i,(F+1)/e(r).length*100),D}),y=await Promise.all(f);y.forEach(M=>{t.onAttachmentUploaded(M)}),o(r,[],!0),o(g,!1),Be(`Successfully uploaded ${y.length} file${y.length!==1?"s":""}`,{icon:ft})}catch(f){console.error("Upload failed:",f),Be("Upload failed. Please try again.",{icon:nt})}finally{o(s,!1),o(i,0)}}}function w(f){f.preventDefault(),o(l,!0)}function C(f){f.preventDefault(),o(l,!1)}async function R(f){var y;f.preventDefault(),o(l,!1),(y=f.dataTransfer)!=null&&y.files&&await L(Array.from(f.dataTransfer.files))}function K(f){return f.type.startsWith("image/")?jt:f.type.startsWith("video/")?Ot:f.type.startsWith("audio/")?Ut:f.type.includes("text")||f.type.includes("json")||f.type.includes("xml")?Bt:Gt}function Q(f){if(f===0)return"0 Bytes";const y=1024,M=["Bytes","KB","MB","GB"],F=Math.floor(Math.log(f)/Math.log(y));return parseFloat((f/Math.pow(y,F)).toFixed(2))+" "+M[F]}var U=Zn();Ie("dragover",je,w),Ie("dragleave",je,C),Ie("drop",je,R);var z=p(U);z.__change=[Un,L],Ve(z,f=>a=f,()=>a);var q=m(z,2);pe(q,{variant:"ghost",size:"sm",class:"h-8 px-2 text-xs",onclick:b,get disabled(){return t.disabled},children:(f,y)=>{var M=Bn(),F=E(M);vn(F,{class:"mr-1 h-3 w-3"}),fe(),u(f,M)},$$slots:{default:!0}});var _=m(q,2);{var $=f=>{var y=qn(),M=p(y),F=m(p(M),2);pe(F,{variant:"ghost",size:"sm",class:"h-6 w-6 p-0",onclick:()=>{o(r,[],!0),o(g,!1)},children:(oe,B)=>{st(oe,{class:"h-3 w-3"})},$$slots:{default:!0}}),v(M);var D=m(M,2);Ae(D,21,()=>e(r),Ge,(oe,B,se)=>{var J=Gn(),me=p(J);Ce(me,()=>K(e(B)),(ce,ae)=>{ae(ce,{class:"text-muted-foreground h-4 w-4"})});var ee=m(me,2),j=p(ee),H=p(j,!0);v(j);var Z=m(j,2),te=p(Z,!0);v(Z),v(ee);var re=m(ee,2);pe(re,{variant:"ghost",size:"sm",class:"h-6 w-6 p-0",onclick:()=>W(se),children:(ce,ae)=>{st(ce,{class:"h-3 w-3"})},$$slots:{default:!0}}),v(J),de(ce=>{ue(H,e(B).name),ue(te,ce)},[()=>Q(e(B).size)]),u(oe,J)}),v(D);var Y=m(D,2);{var X=oe=>{var B=Hn(),se=p(B),J=m(p(se),2),me=p(J);v(J),v(se);var ee=m(se,2),j=p(ee);v(ee),v(B),de(H=>{ue(me,`${H??""}%`),en(j,`width: ${e(i)??""}%`)},[()=>Math.round(e(i))]),u(oe,B)},he=oe=>{var B=Qn(),se=p(B);const J=ve(()=>e(r).length===0||!t.conversationId);pe(se,{size:"sm",class:"flex-1",onclick:h,get disabled(){return e(J)},children:(me,ee)=>{var j=Vn(),H=E(j);ut(H,{class:"mr-1 h-3 w-3"});var Z=m(H);de(()=>ue(Z,` Upload ${e(r).length??""} file${e(r).length!==1?"s":""}`)),u(me,j)},$$slots:{default:!0}}),v(B),u(oe,B)};G(Y,oe=>{e(s)?oe(X):oe(he,!1)})}v(y),u(f,y)};G(_,f=>{e(g)&&f($)})}var k=m(_,2);{var S=f=>{var y=Jn(),M=p(y),F=p(M);ut(F,{class:"text-primary mx-auto mb-2 h-8 w-8"}),fe(4),v(M),v(y),Ie("dragover",y,w),Ie("dragleave",y,C),Ie("drop",y,R),u(f,y)};G(k,f=>{e(l)&&f(S)})}v(U),de(f=>Yt(z,"accept",f),[()=>N.join(",")]),u(c,U),$e()}Fe(["change"]);function Yn(c,t){c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),t.onSendMessage())}var eo=x('<div class="px-3 pt-3"><div class="text-muted-foreground mb-2 text-xs"> </div> <!></div>'),to=x('<div class="h-3 w-3 animate-spin rounded-full border-2 border-current border-t-transparent"></div>'),no=x('<div class="bg-background/80 absolute right-0 bottom-0 left-0 z-10 px-4 backdrop-blur-[2px]"><div class="relative mx-auto max-w-sm sm:max-w-lg md:max-w-2xl lg:max-w-4xl xl:max-w-5xl"><div class="bg-muted/10 relative overflow-visible rounded-t-lg border border-b-0"><div class="to-background/25 pointer-events-none absolute -top-6 right-0 left-0 h-6 bg-gradient-to-t from-transparent"></div> <!> <textarea placeholder="Type your message here..." class="placeholder:text-muted-foreground/60 min-h-[80px] w-full resize-none border-0 bg-transparent px-3 py-3 text-base focus:ring-0 focus:outline-none"></textarea> <div class="flex items-center justify-between bg-transparent px-3 py-2"><div class="flex items-center gap-2"><!> <!>  <!></div> <!></div></div> <div class="bg-muted/10 h-1 border-r border-l"></div></div></div>');function oo(c,t){ke(t,!0);let a=V(t,"inputValue",15,""),l=V(t,"isConnected",11,!1),s=V(t,"isStreaming",11,!1),i=V(t,"conversationId",11,null),r=V(t,"currentProvider",11,"anthropic"),g=V(t,"currentModel",11,"claude-sonnet-4-20250514"),A=V(t,"reasoningEffort",11,"medium"),N=V(t,"pendingAttachments",27,()=>Te([])),b=V(t,"currentMessageAttachments",27,()=>Te([])),L=V(t,"pendingMessageId",11,null),W=ve(()=>N().length+b().length);var h=no(),w=p(h),C=p(w),R=m(p(C),2);{var K=f=>{var y=eo(),M=p(y),F=p(M);v(M);var D=m(M,2);const Y=ve(()=>[...N(),...b()]);Vt(D,{get attachments(){return e(Y)}}),v(y),de(()=>ue(F,`Attachments (${N().length??""} pending, ${b().length??""} for
						message, total: ${e(W)??""}):`)),u(f,y)};G(R,f=>{e(W)>0&&f(K)})}var Q=m(R,2);Mt(Q),Q.__keydown=[Yn,t];var U=m(Q,2),z=p(U),q=p(z);Wn(q,{get currentProvider(){return r()},get currentModel(){return g()},get conversationId(){return i()},get onProviderChange(){return t.onProviderChange},get disabled(){return s()},get userSettings(){return t.userSettings}});var _=m(q,2);On(_,{get modelId(){return g()},get provider(){return r()},get reasoningEffort(){return A()},get onReasoningEffortChange(){return t.onReasoningEffortChange},get disabled(){return s()}});var $=m(_,2);Xn($,{get conversationId(){return i()},get messageId(){return L()},get disabled(){return s()},get onAttachmentUploaded(){return t.onAttachmentUploaded},get ensureMessageId(){return t.ensureMessageId}}),v(z);var k=m(z,2);const S=ve(()=>!l()||s()||!a().trim());pe(k,{get onclick(){return t.onSendMessage},get disabled(){return e(S)},size:"sm",class:"h-8",children:(f,y)=>{var M=ne(),F=E(M);{var D=X=>{var he=to();u(X,he)},Y=X=>{gn(X,{class:"h-3 w-3"})};G(F,X=>{s()?X(D):X(Y,!1)})}u(f,M)},$$slots:{default:!0}}),v(U),v(C),fe(2),v(w),v(h),de(()=>Q.disabled=!l()||s()),qt(Q,a),u(c,h),$e()}Fe(["keydown"]);var ro=x('<div class="mx-auto max-w-4xl svelte-buhjx7"><div class="mb-4 svelte-buhjx7"><details class="bg-muted/20 border-border/30 rounded-lg border svelte-buhjx7" open><summary class="text-muted-foreground hover:bg-muted/30 cursor-pointer rounded-lg p-3 text-sm font-medium transition-colors svelte-buhjx7">Reasoning...</summary> <div class="text-muted-foreground border-border/20 mt-2 border-t px-3 pt-1 pb-3 font-mono text-xs leading-relaxed whitespace-pre-wrap svelte-buhjx7"> </div></details></div></div>');function ao(c,t){ke(t,!0);let a=V(t,"isThinking",11,!1),l=V(t,"currentThinkingContent",11,""),s=V(t,"thinkingMessageId",11,null);var i=ne(),r=E(i);{var g=A=>{var N=ro(),b=p(N),L=p(b),W=m(p(L),2),h=p(W,!0);v(W),v(L),v(b),v(N),de(()=>ue(h,l())),u(A,N)};G(r,A=>{a()&&l()&&s()&&A(g)})}u(c,i),$e()}var so=x('<div class="mx-auto max-w-4xl svelte-1yghze7"><div class="pt-6 pb-2 text-base leading-7 svelte-1yghze7"><span class="terminal-cursor font-mono text-lg text-current svelte-1yghze7"><span class="cursor-bar cursor-bar-1 svelte-1yghze7">|</span> <span class="cursor-bar cursor-bar-2 svelte-1yghze7">|</span> <span class="cursor-bar cursor-bar-3 svelte-1yghze7">|</span></span></div></div>'),io=x('<span class="svelte-1yghze7">Scroll to bottom</span> <!>',1),lo=x('<div class="absolute bottom-40 left-1/2 z-20 -translate-x-1/2 transform svelte-1yghze7"><!></div>'),co=x("<!> <!>",1);function uo(c,t){ke(t,!0);let a=V(t,"isWaitingForResponse",11,!1),l=V(t,"showScrollButton",11,!1),s=V(t,"isThinking",3,!1);var i=co(),r=E(i);{var g=b=>{var L=so();u(b,L)};G(r,b=>{(a()||s())&&b(g)})}var A=m(r,2);{var N=b=>{var L=lo(),W=p(L);pe(W,{get onclick(){return t.onScrollToBottom},variant:"secondary",size:"sm",class:"bg-background hover:bg-accent flex h-8 items-center gap-1 rounded-full px-3 py-1 text-xs shadow-lg transition-all hover:shadow-xl",children:(h,w)=>{var C=io(),R=m(E(C),2);Qe(R,{class:"h-3 w-3"}),u(h,C)},$$slots:{default:!0}}),v(L),u(b,L)};G(A,b=>{l()&&b(N)})}u(c,i),$e()}var vo=x("<!> ",1),go=(c,t,a)=>t.onSuggestedPrompt(e(a)),fo=x('<button class="block w-full text-left p-4 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors text-gray-700 dark:text-gray-300"> </button>'),po=x('<div class="flex flex-col items-center justify-center h-full p-8 text-center"><div class="max-w-2xl mx-auto"><h1 class="text-4xl font-semibold text-gray-900 dark:text-gray-100 mb-8"> </h1> <div class="flex flex-wrap gap-4 justify-center mb-12"></div> <div class="space-y-4"></div></div></div>');function mo(c,t){ke(t,!0);let a=I("create");const l=[{id:"create",icon:fn,label:"Create",prompt:"Help me create a new project or feature"},{id:"explore",icon:ln,label:"Explore",prompt:"I want to explore and learn about a topic"},{id:"code",icon:cn,label:"Code",prompt:"Help me with coding or technical problems"},{id:"learn",icon:un,label:"Learn",prompt:"Teach me something new or explain a concept"}],s={create:["Write a short story about a robot discovering emotions","Help me outline a sci-fi novel set in a post-apocalyptic world","Create a character profile for a complex villain with sympathetic motives","Give me 5 creative writing prompts for flash fiction"],explore:["Good books for fans of Rick Rubin","Countries ranked by number of corgis","Most successful companies in the world","How much does Claude cost?"],code:["Write code to invert a binary search tree in Python","What's the difference between Promise.all and Promise.allSettled?","Explain React's useEffect cleanup function","Best practices for error handling in async/await"],learn:["Beginner's guide to TypeScript","Explain the CAP theorem in distributed systems","Why is AI so expensive?","Are black holes real?"]};let i=ve(()=>s[e(a)]);var r=po(),g=p(r),A=p(g),N=p(A);v(A);var b=m(A,2);Ae(b,21,()=>l,Ge,(W,h)=>{const w=ve(()=>e(h).icon),C=ve(()=>e(a)===e(h).id?"default":"outline");pe(W,{get variant(){return e(C)},class:"flex items-center gap-2 px-6 py-3 text-sm font-medium rounded-full hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",onclick:()=>o(a,e(h).id,!0),children:(R,K)=>{var Q=vo(),U=E(Q);Ce(U,()=>e(w),(q,_)=>{_(q,{class:"w-4 h-4"})});var z=m(U);de(()=>ue(z,` ${e(h).label??""}`)),u(R,Q)},$$slots:{default:!0}})}),v(b);var L=m(b,2);Ae(L,21,()=>e(i),Ge,(W,h)=>{var w=fo();w.__click=[go,t,h];var C=p(w,!0);v(w),de(()=>ue(C,e(h))),u(W,w)}),v(L),v(g),v(r),de(()=>ue(N,`How can I help you${t.username?`, ${t.username}`:""}?`)),u(c,r),$e()}Fe(["click"]);var ho=x('<div class="h-full overflow-x-visible overflow-y-auto p-4 pb-40"><!> <!> <!></div>'),wo=x('<div class="relative h-screen"><!> <!></div>');function _o(c,t){ke(t,!0);const[a,l]=Wt(),s=()=>Et(Rt,"$page",a);let i,r=I(Te([])),g="",A=I(""),N=I(!1),b=I(!1),L=I(!1),W=I(null),h=null,w=I(null),C=I(!1),R=I(""),K=I(null),Q=I(Te(new Map)),U=I("anthropic"),z=I("claude-sonnet-4-20250514"),q=I("medium"),_=I(!1),$,k=I(Te([])),S=I(null),f=I(Te([])),y=I(null),M=I(void 0),F=ve(()=>!e(W)&&e(r).length===0&&!e(b)&&!e(L));const D=At("conversation-refresh"),Y=D==null?void 0:D();let X=ve(()=>e(S)?e(f).filter(n=>n.messageId===e(S)).map(n=>n.attachment):[]),he=ve(()=>s().url.searchParams.get("c")),oe=null,B=!1;We(async()=>{const n=e(he);if(n!==oe&&!B){if(console.log("ðŸ”„ Loading conversation:",n,"previous:",oe),B=!0,oe=n,o(W,n,!0),o(w,null),o(r,[],!0),o(b,!1),h=null,g="",o(C,!1),o(R,""),o(K,null),e(Q).clear(),console.log("ðŸ” WebSocket state - chatClient exists:",!!i,"isConnected:",i==null?void 0:i.isConnected()),i&&i.isConnected())try{if(n)if(Re.isInitialized()){const d=await Ue(n);if(console.log("ðŸ“„ Local SQLite conversation result:",d),o(w,d,!0),e(w)){o(U,e(w).provider||"openai",!0),o(z,e(w).model||"gpt-4.1-mini",!0);try{const P=await et(n);console.log("ðŸ“„ Local SQLite messages result:",P.length,"messages"),o(r,P,!0)}catch(P){console.error("Failed to load messages from SQLite:",P)}}else console.log("ðŸ†• New conversation with pre-generated ID:",n)}else console.log("â³ Database not ready yet, will load conversation from WebSocket response");console.log("ðŸ”„ Requesting conversation switch via WebSocket:",n),await i.switchConversation(n)}catch(d){console.error("Failed to load conversation:",d)}else if(n)try{if(Re.isInitialized())if(o(w,await Ue(n),!0),e(w)){o(U,e(w).provider||"openai",!0),o(z,e(w).model||"gpt-4.1-mini",!0);try{const d=await et(n);console.log("ðŸ“„ Local SQLite messages result (fallback):",d.length,"messages"),o(r,d,!0)}catch(d){console.error("Failed to load messages from SQLite (fallback):",d)}}else console.log("ðŸ†• New conversation with pre-generated ID:",n);else console.log("â³ Database and WebSocket not ready yet, conversation will load when ready")}catch(d){console.error("Failed to load conversation from local SQLite:",d)}B=!1}});async function se(){try{const n=await ht["user-settings"].$get();if(n.ok){const d=await n.json();o(y,{credits:d.credits},!0);const P=vt();P&&P.startsWith("github:")&&o(M,P.replace("github:",""),!0)}}catch(n){console.error("Failed to load user settings:",n)}}He(async()=>{await se(),i=new pn,i.on("connected",()=>{console.log("ðŸ”Œ WebSocket connected"),o(N,!0),it(!0);const n=s().url.searchParams.get("c");console.log("ðŸ” On WebSocket connect - URL conversation ID:",n),n&&(console.log("ðŸ”„ WebSocket connected, requesting conversation from URL:",n),i.switchConversation(n))}),i.on("disconnected",()=>{console.log("ðŸ”Œ WebSocket disconnected"),o(N,!1),it(!1)}),i.on("conversation_switched",async n=>{if(console.log("ðŸ”„ Received conversation_switched:",n),console.log("ðŸ” Current conversation ID from URL:",e(he)),n.conversationId){if(n.conversation&&(o(w,{id:n.conversation.id,title:n.conversation.title,model:n.conversation.model,provider:n.conversation.provider,createdAt:new Date(n.conversation.createdAt),updatedAt:new Date(n.conversation.updatedAt)},!0),o(U,e(w).provider||"anthropic",!0),o(z,e(w).model||"claude-sonnet-4-20250514",!0)),n.messages&&o(r,n.messages.map(d=>({id:d.id,role:d.role,content:d.content,isStreaming:d.isStreaming||!1,streamCompleted:d.streamCompleted!==!1})),!0),n.hasActiveStream){o(b,!0);const d=e(r).find(P=>P.isStreaming);d&&(h=d.id,g=d.content)}}else o(w,null),o(r,[],!0),o(b,!1),h=null,g="",o(C,!1),o(R,""),o(K,null),e(Q).clear()}),i.on("conversation_updated",async n=>{console.log("ðŸ”„ Received conversation_updated:",n),n.conversation&&n.conversation.id===e(W)&&(o(w,{id:n.conversation.id,title:n.conversation.title,model:n.conversation.model,provider:n.conversation.provider,createdAt:new Date(n.conversation.createdAt),updatedAt:new Date(n.conversation.updatedAt)},!0),await tt(n.conversation.id,n.conversation.title),console.log("âœ… Updated conversation title:",n.conversation.title),window.dispatchEvent(new CustomEvent("conversation-title-updated",{detail:{conversationId:n.conversation.id,title:n.conversation.title}})))}),i.on("text",async n=>{if(console.log("ðŸ“¥ Received text message:",n),n.content){const d=n.messageId||h;console.log("ðŸŽ¯ Processing text for message:",d,"current streaming:",h),d&&(d===h&&(g+=n.content,console.log("ðŸ“ Updated currentMessage length:",g.length)),o(r,e(r).map(P=>{if(P.id===d){const O=d===h?g:P.content+n.content;return{...P,content:O}}return P}),!0))}}),i.on("done",async n=>{console.log("âœ… Received done message:",n);const d=n.messageId||h;d===h&&(console.log("ðŸ Stopping streaming for message:",d),o(L,!1),o(b,!1),h=null,g=""),d&&o(r,e(r).map(P=>P.id===d?{...P,streaming:!1,isStreaming:!1,streamCompleted:!0,usage:n.usage||P.usage}:P),!0)}),i.on("catchup",n=>{if(n.messages&&o(r,n.messages.map(d=>({id:d.id,role:d.role,content:d.content,streaming:d.isStreaming})),!0),n.hasActiveStream){o(b,!0);const d=e(r).find(P=>P.streaming);d&&(h=d.id,g=d.content)}}),i.on("new_message",async n=>{if(console.log("ðŸ“¨ Received new_message:",n),n.message){const d={id:n.message.id,role:n.message.role,content:n.message.content,model:n.message.model,provider:n.message.provider,streaming:n.message.streaming||!1};console.log("âž• Adding new message to UI:",d),o(r,[...e(r),d],!0),d.streaming&&d.role==="assistant"&&(console.log("ðŸŽ¯ Setting currentStreamingMessageId:",d.id),o(b,!0),h=d.id,g=d.content)}}),i.on("error",n=>{console.error("âŒ Chat error:",n.message),o(L,!1),o(b,!1),o(C,!1)}),i.on("thinking_start",n=>{console.log("ðŸ§  Thinking phase started:",n),o(C,!0),o(L,!1),o(R,""),o(K,n.messageId||h,!0)}),i.on("thinking",n=>{console.log("ðŸ§  Received thinking token:",n),n.content&&o(R,e(R)+n.content)}),i.on("thinking_end",n=>{console.log("ðŸ§  Thinking phase ended:",n);const d=n.messageId||e(K);d&&e(R)&&e(Q).set(d,e(R))}),i.on("response_start",n=>{console.log("ðŸ’¬ Response phase started:",n),o(C,!1),o(L,!1)});try{await i.connect()}catch(n){console.error("Failed to connect:",n)}}),Nt(()=>{i&&i.disconnect()});let J=!1;async function me(){if(!e(S)){const{uuidv7:n}=await Oe(async()=>{const{uuidv7:d}=await import("../chunks/D9TWUjiN.js").then(P=>P.l);return{uuidv7:d}},__vite__mapDeps([0,1,2,3]),import.meta.url);o(S,n(),!0)}return e(S)}async function ee(n){console.log("Attachment uploaded:",n),console.log("Current pendingMessageId:",e(S)),console.log("Current pendingAttachments length:",e(k).length),e(S)?(e(f).push({attachment:n,messageId:e(S)}),console.log("Added to allAttachments for message:",e(S),"total:",e(f).length)):(o(k,[...e(k),n],!0),console.log("Added to pendingAttachments, new length:",e(k).length))}async function j(){if(console.log("ðŸš€ sendMessage called"),console.log("ðŸ“‹ State check:",{inputValue:e(A).trim(),isConnected:e(N),isStreaming:e(b),isCreatingConversation:J,conversationId:e(W)}),!e(A).trim()||!e(N)||e(b)||J){console.log("âŒ sendMessage early return - conditions not met");return}const n=e(A).trim();o(A,""),console.log("ðŸ’¬ Message content:",n);try{const{uuidv7:d}=await Oe(async()=>{const{uuidv7:T}=await import("../chunks/D9TWUjiN.js").then(Se=>Se.l);return{uuidv7:T}},__vite__mapDeps([0,1,2,3]),import.meta.url),P=e(S)||d();console.log("ðŸŽ² Generated/using message ID:",P);let O=e(W);console.log("ðŸ†” Current conversation ID:",O);let ge=!1;if(!O&&!J?(console.log("ðŸ†• Creating new conversation (no ID)"),ge=!0,J=!0,O=d(),console.log("ðŸŽ² Generated conversation ID:",O)):O&&!e(w)&&!J&&(console.log("ðŸ†• Creating new conversation (pre-assigned ID)"),ge=!0,J=!0),ge&&O){if(console.log("ðŸ’¾ Creating conversation with state:",{currentProvider:e(U),currentModel:e(z)}),await Ft({id:O,title:"...",model:e(z),provider:e(U)}),console.log("ðŸ’¾ Created conversation in local database"),Y?(console.log("ðŸ”„ Triggering sidebar refresh for new conversation"),Y.trigger()):console.warn("âŒ conversationRefresh context not available"),oe=O,o(W,O,!0),o(w,await Ue(O),!0),console.log("ðŸ“ Updated conversation state:",e(w)),!e(W)&&O){const T=new URL(s().url);T.searchParams.set("c",O),Ye(T.toString(),{replaceState:!0,noScroll:!0}),console.log("ðŸ”— Updated URL:",T.toString())}J=!1}if(console.log("ðŸ”„ Setting waiting state"),o(L,!0),o(b,!1),console.log("ðŸ”„ isWaitingForResponse:",e(L)),g="",h=null,console.log("ðŸ“¤ Sending message via WebSocket:",{messageContent:n,messageId:P,conversationId:O,webSocketConnected:i==null?void 0:i.isConnected()}),i.startChat(n,O||void 0,P||void 0,e(U),e(z),e(q)),e(k).length>0&&P)for(const T of e(k))e(f).push({attachment:T,messageId:P});o(S,null),o(k,[],!0)}catch(d){console.error("Failed to save message:",d)}}async function H(n,d){if(console.log("ðŸ”„ Frontend Provider changed:",{provider:n,model:d,conversationId:e(W)}),console.log("ðŸ”„ State before change:",{currentProvider:e(U),currentModel:e(z)}),o(U,n,!0),o(z,d,!0),console.log("ðŸ”„ State after change:",{currentProvider:e(U),currentModel:e(z)}),e(w))try{await tt(e(w).id,e(w).title),console.log("âœ… Provider switched successfully")}catch(P){console.error("Failed to update conversation locally:",P)}}function Z(n){console.log("ðŸ§  Reasoning effort changed:",n),o(q,n,!0)}function te(){if(!$)return;const{scrollTop:n,scrollHeight:d,clientHeight:P}=$,O=d-n-P<150;o(_,!O&&e(r).length>0,!0)}function re(){$&&$.scrollTo({top:$.scrollHeight,behavior:"smooth"})}We(()=>{$&&e(r).length>0&&setTimeout(()=>te(),50)});async function ce(n){if(!e(W)){const{uuidv7:d}=await Oe(async()=>{const{uuidv7:ge}=await import("../chunks/D9TWUjiN.js").then(T=>T.l);return{uuidv7:ge}},__vite__mapDeps([0,1,2,3]),import.meta.url),P=d(),O=new URL(s().url);O.searchParams.set("c",P),await Ye(O.toString(),{replaceState:!0,noScroll:!0})}o(A,n,!0),setTimeout(()=>{const d=document.querySelector('textarea[placeholder*="message"]');d&&d.focus()},100)}var ae=wo(),ie=p(ae);{var Pe=n=>{mo(n,{get username(){return e(M)},onSuggestedPrompt:ce})},le=n=>{var d=ho(),P=p(d);Qt(P,{get conversationId(){return e(W)},get messages(){return e(r)},set messages(T){o(r,T,!0)},get allAttachments(){return e(f)},set allAttachments(T){o(f,T,!0)},get isStreaming(){return e(b)},set isStreaming(T){o(b,T,!0)},get reasoningHistory(){return e(Q)},set reasoningHistory(T){o(Q,T,!0)}});var O=m(P,2);ao(O,{get isThinking(){return e(C)},set isThinking(T){o(C,T,!0)},get currentThinkingContent(){return e(R)},set currentThinkingContent(T){o(R,T,!0)},get thinkingMessageId(){return e(K)},set thinkingMessageId(T){o(K,T,!0)}});var ge=m(O,2);uo(ge,{get isThinking(){return e(C)},onScrollToBottom:re,get isWaitingForResponse(){return e(L)},set isWaitingForResponse(T){o(L,T,!0)},get showScrollButton(){return e(_)},set showScrollButton(T){o(_,T,!0)}}),v(d),Ve(d,T=>$=T,()=>$),Ie("scroll",d,te),u(n,d)};G(ie,n=>{e(F)?n(Pe):n(le,!1)})}var we=m(ie,2);oo(we,{onSendMessage:j,onProviderChange:H,onReasoningEffortChange:Z,onAttachmentUploaded:ee,ensureMessageId:me,get userSettings(){return e(y)},get inputValue(){return e(A)},set inputValue(n){o(A,n,!0)},get isConnected(){return e(N)},set isConnected(n){o(N,n,!0)},get isStreaming(){return e(b)},set isStreaming(n){o(b,n,!0)},get conversationId(){return e(W)},set conversationId(n){o(W,n,!0)},get currentProvider(){return e(U)},set currentProvider(n){o(U,n,!0)},get currentModel(){return e(z)},set currentModel(n){o(z,n,!0)},get reasoningEffort(){return e(q)},set reasoningEffort(n){o(q,n,!0)},get pendingAttachments(){return e(k)},set pendingAttachments(n){o(k,n,!0)},get currentMessageAttachments(){return e(X)},set currentMessageAttachments(n){o(X,n,!0)},get pendingMessageId(){return e(S)},set pendingMessageId(n){o(S,n,!0)}}),v(ae),u(c,ae),$e(),l()}var xo=x('<div class="bg-primary/10 mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full"><!></div> <!> <!>',1),yo=x("<!> Continue with GitHub",1),bo=x("<!> Login with Code",1),ko=x("<!> Start Chatting as Guest",1),$o=x('<div class="space-y-2"><!> <!></div>'),Po=x('<p class="text-destructive text-sm"> </p>'),Co=x('<span class="mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"></span>'),So=x("<!> Login",1),Mo=x('<div class="space-y-3"><div class="space-y-2"><!> <!></div> <div class="flex gap-2"><!> <!></div></div>'),To=x('<!> <div class="relative"><div class="absolute inset-0 flex items-center"><span class="border-border/20 w-full border-t"></span></div> <div class="relative flex justify-center text-xs uppercase"><span class="text-muted-foreground px-2">Or</span></div></div> <!>',1),Io=x('<p class="text-muted-foreground text-xs">By continuing, you agree to our Terms of Service and Privacy Policy.</p>'),Ao=x("<!> <!> <!>",1),No=x('<div class="bg-background flex min-h-screen items-center justify-center p-4"><div class="w-full max-w-md"><!> <div class="mt-8 grid grid-cols-1 gap-4 text-center sm:grid-cols-3"><div class="space-y-2"><div class="mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900/20"><!></div> <h3 class="text-sm font-medium">AI Conversations</h3> <p class="text-muted-foreground text-xs">Chat with multiple AI models</p></div> <div class="space-y-2"><div class="mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/20"><!></div> <h3 class="text-sm font-medium">Seamless Access</h3> <p class="text-muted-foreground text-xs">Quick setup with GitHub or guest mode</p></div> <div class="space-y-2"><div class="mx-auto flex h-8 w-8 items-center justify-center rounded-full bg-purple-100 dark:bg-purple-900/20"><!></div> <h3 class="text-sm font-medium">Persistent Chats</h3> <p class="text-muted-foreground text-xs">Save conversations with account</p></div></div></div></div>');function Lo(c,t){ke(t,!0);let a=I(!1),l=I(""),s=I(!1),i=I(null);function r(){{const $=new URL("/oauth/login/github",location.href);$.protocol="https",window.location.href=$.toString()}}function g(){t.onStartAnonymous&&t.onStartAnonymous()}function A(){o(a,!e(a)),o(i,null),o(l,"")}async function N(){if(!e(l).trim()){o(i,"Please enter your login code");return}o(s,!0),o(i,null);try{const k=await fetch(`${sn?"http://localhost:5787":""}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyLogin:e(l).trim()}),credentials:"include"});if(k.ok)window.location.reload();else{const S=await k.json();o(i,S.error||"Login failed",!0)}}catch($){console.error("Login error:",$),o(i,"Network error. Please try again.")}finally{o(s,!1)}}var b=No(),L=p(b),W=p(L);Ce(W,()=>mt,($,k)=>{k($,{class:"border-border/20 shadow-lg",children:(S,f)=>{var y=Ao(),M=E(y);Ce(M,()=>nn,(Y,X)=>{X(Y,{class:"text-center",children:(he,oe)=>{var B=xo(),se=E(B),J=p(se);ct(J,{class:"text-primary h-6 w-6"}),v(se);var me=m(se,2);Ce(me,()=>on,(j,H)=>{H(j,{class:"text-2xl font-bold",children:(Z,te)=>{fe();var re=Ee("Welcome to DuraChat");u(Z,re)},$$slots:{default:!0}})});var ee=m(me,2);Ce(ee,()=>rn,(j,H)=>{H(j,{class:"text-muted-foreground",children:(Z,te)=>{fe();var re=Ee(`Start chatting with AI assistants. Sign in for a personalized experience or continue as a
					guest.`);u(Z,re)},$$slots:{default:!0}})}),u(he,B)},$$slots:{default:!0}})});var F=m(M,2);Ce(F,()=>pt,(Y,X)=>{X(Y,{class:"space-y-4",children:(he,oe)=>{var B=To(),se=E(B);pe(se,{onclick:r,class:"w-full",variant:"default",children:(j,H)=>{var Z=yo(),te=E(Z);lt(te,{class:"mr-2 h-4 w-4"}),fe(),u(j,Z)},$$slots:{default:!0}});var J=m(se,4);{var me=j=>{var H=$o(),Z=p(H);pe(Z,{onclick:A,class:"w-full",variant:"outline",children:(re,ce)=>{var ae=bo(),ie=E(ae);rt(ie,{class:"mr-2 h-4 w-4"}),fe(),u(re,ae)},$$slots:{default:!0}});var te=m(Z,2);pe(te,{onclick:g,class:"w-full",variant:"outline",children:(re,ce)=>{var ae=ko(),ie=E(ae);dt(ie,{class:"mr-2 h-4 w-4"}),fe(),u(re,ae)},$$slots:{default:!0}}),v(H),u(j,H)},ee=j=>{var H=Mo(),Z=p(H),te=p(Z);gt(te,{placeholder:"Enter your login code",get disabled(){return e(s)},onkeydown:le=>{le.key==="Enter"&&N()},get value(){return e(l)},set value(le){o(l,le,!0)}});var re=m(te,2);{var ce=le=>{var we=Po(),n=p(we,!0);v(we),de(()=>ue(n,e(i))),u(le,we)};G(re,le=>{e(i)&&le(ce)})}v(Z);var ae=m(Z,2),ie=p(ae);pe(ie,{onclick:N,class:"flex-1",variant:"default",get disabled(){return e(s)},children:(le,we)=>{var n=So(),d=E(n);{var P=ge=>{var T=Co();u(ge,T)},O=ge=>{rt(ge,{class:"mr-2 h-4 w-4"})};G(d,ge=>{e(s)?ge(P):ge(O,!1)})}fe(),u(le,n)},$$slots:{default:!0}});var Pe=m(ie,2);pe(Pe,{onclick:A,variant:"outline",get disabled(){return e(s)},children:(le,we)=>{fe();var n=Ee("Back");u(le,n)},$$slots:{default:!0}}),v(ae),v(H),u(j,H)};G(J,j=>{e(a)?j(ee,!1):j(me)})}u(he,B)},$$slots:{default:!0}})});var D=m(F,2);Ce(D,()=>hn,(Y,X)=>{X(Y,{class:"text-center",children:(he,oe)=>{var B=Io();u(he,B)},$$slots:{default:!0}})}),u(S,y)},$$slots:{default:!0}})});var h=m(W,2),w=p(h),C=p(w),R=p(C);ct(R,{class:"h-4 w-4 text-blue-600 dark:text-blue-400"}),v(C),fe(4),v(w);var K=m(w,2),Q=p(K),U=p(Q);dt(U,{class:"h-4 w-4 text-green-600 dark:text-green-400"}),v(Q),fe(4),v(K);var z=m(K,2),q=p(z),_=p(q);lt(_,{class:"h-4 w-4 text-purple-600 dark:text-purple-400"}),v(q),fe(4),v(z),v(h),v(L),v(b),u(c,b),$e()}var Eo=x('<div class="flex min-h-screen items-center justify-center"><div class="space-y-4 text-center"><div class="border-primary mx-auto h-8 w-8 animate-spin rounded-full border-2 border-t-transparent"></div> <div class="text-muted-foreground text-sm"> </div></div></div>');function Yo(c,t){ke(t,!0);let a=I(!1),l=I(!0),s=I(null),i=I(!1);He(async()=>{await r()});async function r(){try{if(o(s,vt(),!0),!e(s)){o(a,!1),o(l,!1);return}const[h,w]=await Promise.allSettled([Re.initialize(e(s)),zt()]);if(w.status==="fulfilled"&&w.value)if(h.status==="fulfilled")o(a,!0),o(i,!0);else throw console.error("Database initialization failed:",h.reason),new Error("Failed to initialize database");else console.log("Session verification failed, clearing session"),await g()}catch(h){console.error("App initialization failed:",h),await g()}finally{o(l,!1)}}async function g(){e(i)&&(await Re.cleanup(),o(i,!1)),Dt(),o(s,null),o(a,!1)}async function A(){o(l,!0);try{await Kt()&&await r()}catch(h){console.error("Failed to create anonymous session:",h)}finally{e(a)||o(l,!1)}}var N=ne(),b=E(N);{var L=h=>{var w=Eo(),C=p(w),R=m(p(C),2),K=p(R,!0);v(R),v(C),v(w),de(()=>ue(K,e(s)?"Initializing database and verifying session...":"Loading...")),u(h,w)},W=(h,w)=>{{var C=K=>{_o(K,{})},R=K=>{Lo(K,{onStartAnonymous:A})};G(h,K=>{e(a)&&e(i)?K(C):K(R,!1)},w)}};G(b,h=>{e(l)?h(L):h(W,!1)})}u(c,N),$e()}export{Yo as component};
